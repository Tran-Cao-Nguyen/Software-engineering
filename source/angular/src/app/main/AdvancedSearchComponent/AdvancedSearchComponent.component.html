<!--TODO: font khoong dis vaof component mà phải bỏ vào header-->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">

<div class="table-container">
    <div class="button-container"><button class="search-button" (click)="search()">Tim kiem</button></div>
    <div class="search-container" *ngIf="advancedSearch">
        <div class="flex-container">
            <div class="input-field">
                <div class="title-field">
                    <p class="title-input">So hieu van ban</p>
                </div>
                <div class="text-field">
                    <input type="text" name="search" class="search-bar" [value]="searchParams.code ?? ''" (input)="onCodeChange($event.target.value); showCodeOptions = true; fetchCode()" (blur)="onBlur()">
                    <div class="options-list" *ngIf="showCodeOptions">
                        <table>
                            <tr *ngFor="let option of codeOptions" (click)="onCodeChange(option); showCodeOptions = false">
                                <td>{{ option }}</td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
            <div class="input-field">
                <div class="title-field">
                    <p class="title-input">Tieu de</p>
                </div>
                <div class="text-field">
                    <input type="text" name="search" class="search-bar" [value]="searchParams.title ?? ''" (input)="onTitleChange($event.target.value); showTitleOptions = true; fetchTitle()" (blur)="onBlur()">
                    <div class="options-list" *ngIf="showTitleOptions">
                        <table>
                            <tr *ngFor="let option of titleOptions" (click)="onTitleChange(option); showTitleOptions = false">
                                <td>{{ option }}</td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div class="flex-container">
            <div class="input-field">
                <div class="title-field">
                    <p class="title-input">Trich yeu</p>
                </div>
                <div class="text-field">
                    <input type="text" name="search" class="search-bar" [value]="searchParams.organization ?? ''" (input)="onOrganizationChange($event.target.value); showOrganizationOptions = true; fetchOrganization()" (blur)="onBlur()">
                    <div class="options-list" *ngIf="showOrganizationOptions">
                        <table>
                            <tr *ngFor="let option of organizationOptions" (click)="onOrganizationChange(option); showOrganizationOptions = false">
                                <td>{{ option }}</td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
            <div class="input-field">
                <div class="title-field">
                    <p class="title-input">Loai van ban</p>
                </div>
                <div class="text-field">
                    <input type="text" id="searchType" name="search" class="search-bar" [value] = "searchParams.type ?? ''" (input)="onTypeChange($event.target.value)" (focus)="showTypeOptions = false; fetchTypeOption()" (blur)="onBlur()">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="9" height="7" viewBox="0 0 9 7" fill="none" (click)="toggleFocus()">
                        <path d="M1.54578 1.28003L4.82254 5.78003L8.0993 1.28003" stroke="#78829D" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <div class="options-list" *ngIf="showTypeOptions">
                        <table>
                            <tr *ngFor="let option of typeOptions" (click)="onTypeChange(option)">
                                <td>{{ option }}</td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div class="flex-container">
            <div class="input-field">
                <div class="title-field">
                    <p class="title-input">Ngay hieu luc</p>
                </div>
                <div class="text-field">
                    <input type="date" name="search" class="search-bar" [(ngModel)]="searchParams.effectiveDate">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="22" height="25" viewBox="0 0 22 25" fill="none">
                        <path d="M0 22.6562C0 23.9502 1.0498 25 2.34375 25H19.5312C20.8252 25 21.875 23.9502 21.875 22.6562V9.375H0V22.6562ZM15.625 13.0859C15.625 12.7637 15.8887 12.5 16.2109 12.5H18.1641C18.4863 12.5 18.75 12.7637 18.75 13.0859V15.0391C18.75 15.3613 18.4863 15.625 18.1641 15.625H16.2109C15.8887 15.625 15.625 15.3613 15.625 15.0391V13.0859ZM15.625 19.3359C15.625 19.0137 15.8887 18.75 16.2109 18.75H18.1641C18.4863 18.75 18.75 19.0137 18.75 19.3359V21.2891C18.75 21.6113 18.4863 21.875 18.1641 21.875H16.2109C15.8887 21.875 15.625 21.6113 15.625 21.2891V19.3359ZM9.375 13.0859C9.375 12.7637 9.63867 12.5 9.96094 12.5H11.9141C12.2363 12.5 12.5 12.7637 12.5 13.0859V15.0391C12.5 15.3613 12.2363 15.625 11.9141 15.625H9.96094C9.63867 15.625 9.375 15.3613 9.375 15.0391V13.0859ZM9.375 19.3359C9.375 19.0137 9.63867 18.75 9.96094 18.75H11.9141C12.2363 18.75 12.5 19.0137 12.5 19.3359V21.2891C12.5 21.6113 12.2363 21.875 11.9141 21.875H9.96094C9.63867 21.875 9.375 21.6113 9.375 21.2891V19.3359ZM3.125 13.0859C3.125 12.7637 3.38867 12.5 3.71094 12.5H5.66406C5.98633 12.5 6.25 12.7637 6.25 13.0859V15.0391C6.25 15.3613 5.98633 15.625 5.66406 15.625H3.71094C3.38867 15.625 3.125 15.3613 3.125 15.0391V13.0859ZM3.125 19.3359C3.125 19.0137 3.38867 18.75 3.71094 18.75H5.66406C5.98633 18.75 6.25 19.0137 6.25 19.3359V21.2891C6.25 21.6113 5.98633 21.875 5.66406 21.875H3.71094C3.38867 21.875 3.125 21.6113 3.125 21.2891V19.3359ZM19.5312 3.125H17.1875V0.78125C17.1875 0.351562 16.8359 0 16.4062 0H14.8438C14.4141 0 14.0625 0.351562 14.0625 0.78125V3.125H7.8125V0.78125C7.8125 0.351562 7.46094 0 7.03125 0H5.46875C5.03906 0 4.6875 0.351562 4.6875 0.78125V3.125H2.34375C1.0498 3.125 0 4.1748 0 5.46875V7.8125H21.875V5.46875C21.875 4.1748 20.8252 3.125 19.5312 3.125Z" fill="#AAAAAA"/>
                    </svg>
                </div>
            </div>
            <div class="input-field">
                <div class="title-field">
                    <p class="title-input">Ngay het hieu luc</p>
                </div>
                <div class="text-field">
                    <input type="date" name="search" class="search-bar" [(ngModel)]="searchParams.expirationDate">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="22" height="25" viewBox="0 0 22 25" fill="none">
                        <path d="M0 22.6562C0 23.9502 1.0498 25 2.34375 25H19.5312C20.8252 25 21.875 23.9502 21.875 22.6562V9.375H0V22.6562ZM15.625 13.0859C15.625 12.7637 15.8887 12.5 16.2109 12.5H18.1641C18.4863 12.5 18.75 12.7637 18.75 13.0859V15.0391C18.75 15.3613 18.4863 15.625 18.1641 15.625H16.2109C15.8887 15.625 15.625 15.3613 15.625 15.0391V13.0859ZM15.625 19.3359C15.625 19.0137 15.8887 18.75 16.2109 18.75H18.1641C18.4863 18.75 18.75 19.0137 18.75 19.3359V21.2891C18.75 21.6113 18.4863 21.875 18.1641 21.875H16.2109C15.8887 21.875 15.625 21.6113 15.625 21.2891V19.3359ZM9.375 13.0859C9.375 12.7637 9.63867 12.5 9.96094 12.5H11.9141C12.2363 12.5 12.5 12.7637 12.5 13.0859V15.0391C12.5 15.3613 12.2363 15.625 11.9141 15.625H9.96094C9.63867 15.625 9.375 15.3613 9.375 15.0391V13.0859ZM9.375 19.3359C9.375 19.0137 9.63867 18.75 9.96094 18.75H11.9141C12.2363 18.75 12.5 19.0137 12.5 19.3359V21.2891C12.5 21.6113 12.2363 21.875 11.9141 21.875H9.96094C9.63867 21.875 9.375 21.6113 9.375 21.2891V19.3359ZM3.125 13.0859C3.125 12.7637 3.38867 12.5 3.71094 12.5H5.66406C5.98633 12.5 6.25 12.7637 6.25 13.0859V15.0391C6.25 15.3613 5.98633 15.625 5.66406 15.625H3.71094C3.38867 15.625 3.125 15.3613 3.125 15.0391V13.0859ZM3.125 19.3359C3.125 19.0137 3.38867 18.75 3.71094 18.75H5.66406C5.98633 18.75 6.25 19.0137 6.25 19.3359V21.2891C6.25 21.6113 5.98633 21.875 5.66406 21.875H3.71094C3.38867 21.875 3.125 21.6113 3.125 21.2891V19.3359ZM19.5312 3.125H17.1875V0.78125C17.1875 0.351562 16.8359 0 16.4062 0H14.8438C14.4141 0 14.0625 0.351562 14.0625 0.78125V3.125H7.8125V0.78125C7.8125 0.351562 7.46094 0 7.03125 0H5.46875C5.03906 0 4.6875 0.351562 4.6875 0.78125V3.125H2.34375C1.0498 3.125 0 4.1748 0 5.46875V7.8125H21.875V5.46875C21.875 4.1748 20.8252 3.125 19.5312 3.125Z" fill="#AAAAAA"/>
                      </svg>
                </div>
            </div>
        </div>
    </div>
    <div class="hidden-container" *ngIf="advancedSearch" (click) ="advancedSearch = !advancedSearch">
        <div class="hidden-icon" >
            <svg xmlns="http://www.w3.org/2000/svg" class="icon-hidden" fill="none">
                <path d="M1.54578 1.28003L4.82254 5.78003L8.0993 1.28003" stroke="#78829D" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </div>
            <p class="hidden">An tim kiem nang cao</p>
    </div>
    <div class="hidden-container" *ngIf="!advancedSearch" (click) ="advancedSearch = !advancedSearch; refresh()">
        <div class="show-icon" >
            <svg xmlns="http://www.w3.org/2000/svg" class="icon-hidden" fill="none">
                <path d="M1.54578 1.28003L4.82254 5.78003L8.0993 1.28003" stroke="#78829D" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </div>
            <p class="hidden">Tim kiem nang cao</p>
    </div>
</div>    
<div class="m-widget1__item" *ngFor="let document of results">
    <div class="row m-row--no-padding align-items-center">
        <div class="col">
            <h3 class="m-widget1__title">{{document.code + ' ' + document.title + ' ' + document.organization + ' ' + document.effectiveDate + ' ' + document.expirationDate}}</h3>
        </div>
    </div>
</div>
<div *ngIf="noResultsFound" class="align-items-center">
    <h1>Khong co van ban phap ly phu hop</h1>
</div>